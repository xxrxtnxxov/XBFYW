
# Экспорт внешних ссылок из Яндекс Вебмастера

Этот скрипт предназначен для экспорта внешних ссылок сайта, зарегистрированного в Яндекс Вебмастере, и сохранения их в файл формата XLSX. Он использует API Яндекс Вебмастера и позволяет выгрузить до 1 000 000 строк данных (лимит файла xlsx).

## Функции

- Извлечение всех внешних ссылок сайта из Яндекс Вебмастера с помощью API.
- Сохранение данных в XLSX-файл с использованием библиотеки `xlsx`.
- Обработка запросов через `GM_xmlhttpRequest` для взаимодействия с API Яндекс Вебмастера.
- Поддержка OAuth для безопасного доступа к данным.

## Установка

1. Установите менеджер пользовательских скриптов, такой как [Tampermonkey](https://www.tampermonkey.net/) или [Greasemonkey](https://www.greasespot.net/).
2. Добавьте скрипт в менеджер, создав новый пользовательский скрипт и вставив содержимое файла `xbdyw.user.js`. Либо нажмите [сюда](https://github.com/xxrxtnxxov/XBFYW/raw/refs/heads/main/xbdyw.user.js), чтобы установить в 1 клик.

## Использование

1. Перейдите [на страницу документации Яндекс Вебмастер](https://yandex.ru/dev/webmaster/doc/ru/tasks/how-to-get-oauth) и выполните все шаги для создания приложения. В конце скопируйте полученный Token в формате: `y0_*****`.
2. Откройте Панель управления в Tampermonkey или Greasemonkey. Найдите установленный скрипт и отредактируйте его, изменив строку `const oauthToken = 'ВАШ_OAUTH_TOKEN'`. Замените значение в `ВАШ_OAUTH_TOKEN` на скопированное значение в 1-м пункте. Должно получиться вот так: `const oauthToken = 'y0_*****'`.
3. Сохранить скрипт с помощью комбинации Ctrl+S или Файл - Сохранить.
4. Откройте нужный сайт и перейдите в раздел «Внешние ссылки». Должна появиться кнопка «Скачать выгрузку XLSX».
5. Готово.

## Зависимости

- `xlsx.full.min.js`: Для сохранения данных в формате XLSX.
- `GM_xmlhttpRequest`: Для выполнения HTTP-запросов к API.

